<!-- FAB Button Urgencias-->
<button
  mat-fab
  class="chat-button"
  color="primary"
  aria-label="Chat"
  matTooltip="Urgencias"
  matTooltipPosition="left"
  matBadge="{{ countNewChats('urgencias') }}"
  matBadgePosition="before"
  matBadgeColor="primary"
  [matBadgeHidden]="countNewChats('urgencias') === 0"
  (click)="viewChat('urgencias')"
>
  <span class="material-icons"> emergency </span>
</button>
<br />

<!-- FAB Button Bomberos-->
<button
  mat-fab
  class="chat-button"
  color="primary"
  aria-label="Chat"
  matTooltip="Bomberos"
  matTooltipPosition="left"
  matBadge="{{ countNewChats('bomberos') }}"
  matBadgePosition="before"
  matBadgeColor="primary"
  [matBadgeHidden]="countNewChats('bomberos') === 0"
  (click)="viewChat('bomberos')"
>
  <span class="material-icons"> fire_truck </span>
</button>
<br />

<!-- FAB Button Policia-->
<button
  mat-fab
  class="chat-button"
  color="primary"
  aria-label="Chat"
  matTooltip="Policia"
  matTooltipPosition="left"
  matBadge="{{ countNewChats('policia') }}"
  matBadgePosition="before"
  matBadgeColor="primary"
  [matBadgeHidden]="countNewChats('policia') === 0"
  (click)="viewChat('policia')"
>
  <span class="material-icons"> local_police </span>
</button>
<br />

<!-- FAB Button Defensa Civil-->
<button
  mat-fab
  class="chat-button"
  color="primary"
  aria-label="Chat"
  matTooltip="Defensa Civil"
  matTooltipPosition="left"
  matBadge="{{ countNewChats('defensa_civil') }}"
  matBadgePosition="before"
  matBadgeColor="primary"
  [matBadgeHidden]="countNewChats('defensa_civil') === 0"
  (click)="viewChat('defensa_civil')"
>
  <span class="material-icons"> flood </span>
</button>
<br />
<!-- END CHAT ICON BUTTON -->

<ng-container *ngIf="chatSeleccionado">
  <mat-card class="chat-service-selected">
    <mat-icon class="close-dialog" (click)="closeChat()">close</mat-icon>
    <p class="service_title">
      {{ chatSeleccionado.idServicio }}
    </p>
    <p class="attendance_title" i18n>
      Asistencia: {{ chatSeleccionado.idAsistencia }}
    </p>

    <div class="chats-container">
      <div
        class="container"
        *ngFor="let dato of chatSeleccionado.dataChat; let i = index"
      >
        <mat-icon>account_circle</mat-icon>
        <ng-container *ngIf="dato.creadoPor == null">
          <p class="chat-user" i18n>tu</p>
        </ng-container>
        <ng-container *ngIf="dato.creadoPor != null">
          <p class="chat-user">{{ dato.creadoPor }}</p>
        </ng-container>
        <div *ngIf="dato.tipoDato == 'imagen' else elseBlock"><img [src]="dato.dato"></div>
        <ng-template #elseBlock><p class="chat-message">{{ dato.dato }}</p></ng-template>
        <span class="time-right">{{ dato.fecha }}</span>
      </div>
    </div>

    <mat-form-field class="form-input-message" appearance="fill">
      <mat-label class="input-message-title" i18n>Mensaje</mat-label>
      <input
        matInput
        id="username"
        name="username"
        #message
        maxlength="50"
        i18n-placeholder
        placeholder="Inserte mensaje"
        #username
        class="input-message"
      />
    </mat-form-field>

    <button
      (click)="sendChat(username.value, chatSeleccionado.idAsistencia)"
      mat-fab
      color="primary"
      i18n-aria-label
      class="send-btn"
    >
      <mat-icon class="icon-chat">send</mat-icon>
    </button>

    <button
      class="close"
      (click)="cancelAttendance(chatSeleccionado.idAsistencia)"
      mat-raised-button
      i18n-aria-label
      title="Cancelar asistencia"
    >
      <span i18n>Cancelar asistencia</span>
    </button>
  </mat-card>
</ng-container>
